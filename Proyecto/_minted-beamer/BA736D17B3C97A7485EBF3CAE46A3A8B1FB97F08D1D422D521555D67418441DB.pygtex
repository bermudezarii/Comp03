\begin{Verbatim}[commandchars=\\\{\}]
\PYG{k}{typedef} \PYG{k+kt}{char} \PYG{o}{*} \PYG{n}{A} \PYG{p}{;} \PYG{k+kt}{int} \PYG{o}{*} \PYG{n}{C} \PYG{p}{,} \PYG{n}{E} \PYG{p}{[} \PYG{l+m+mi}{999} \PYG{p}{]} \PYG{p}{,} \PYG{n}{L} \PYG{p}{[} \PYG{l+m+mi}{999} \PYG{p}{]} \PYG{p}{,} \PYG{n}{M} \PYG{p}{[} \PYG{l+m+mi}{999} \PYG{p}{]} \PYG{p}{,} \PYG{n}{P} \PYG{p}{[} \PYG{l+m+mi}{999} \PYG{p}{]} \PYG{p}{,} \PYG{n}{l} \PYG{p}{,} \PYG{n}{i} \PYG{p}{,} \PYG{n}{j} \PYG{p}{;} \PYG{k+kt}{char} \PYG{n}{B} \PYG{p}{[} \PYG{l+m+mi}{999} \PYG{p}{]} \PYG{p}{,} \PYG{n}{F} \PYG{p}{[} \PYG{l+m+mi}{2} \PYG{p}{]} \PYG{p}{;} \PYG{n}{A} \PYG{n}{m} \PYG{p}{[} \PYG{l+m+mi}{12} \PYG{o}{*} \PYG{l+m+mi}{999} \PYG{p}{]} \PYG{p}{,} \PYG{n}{malloc}
\PYG{p}{(} \PYG{p}{)} \PYG{p}{,} \PYG{n}{p} \PYG{p}{,} \PYG{n}{q} \PYG{p}{,} \PYG{n}{x} \PYG{p}{,} \PYG{n}{y} \PYG{p}{,} \PYG{n}{z} \PYG{p}{,} \PYG{n}{s} \PYG{p}{,} \PYG{n}{d} \PYG{p}{,} \PYG{n}{f} \PYG{p}{,} \PYG{n}{fopen} \PYG{p}{(} \PYG{p}{)} \PYG{p}{;} \PYG{n}{A} \PYG{n+nf}{Q} \PYG{p}{(} \PYG{n}{s} \PYG{p}{,} \PYG{n}{o} \PYG{p}{)} \PYG{n}{A} \PYG{n}{s} \PYG{p}{,} \PYG{n}{o} \PYG{p}{;} \PYG{p}{\PYGZob{}} \PYG{k}{for} \PYG{p}{(} \PYG{n}{x} \PYG{o}{=} \PYG{n}{s} \PYG{p}{;} \PYG{o}{*} \PYG{n}{x} \PYG{p}{;} \PYG{n}{x} \PYG{o}{++} \PYG{p}{)} \PYG{p}{\PYGZob{}} \PYG{k}{for} \PYG{p}{(} \PYG{n}{y} \PYG{o}{=} \PYG{n}{x} \PYG{p}{,} \PYG{n}{z} \PYG{o}{=} \PYG{n}{o} \PYG{p}{;} \PYG{o}{*} \PYG{n}{z} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{o}{*} \PYG{n}{y} \PYG{o}{==}
\PYG{o}{*} \PYG{n}{z} \PYG{p}{;} \PYG{n}{y} \PYG{o}{++} \PYG{p}{)} \PYG{n}{z} \PYG{o}{++} \PYG{p}{;} \PYG{k}{if} \PYG{p}{(} \PYG{n}{z} \PYG{o}{\PYGZgt{}} \PYG{n}{o} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{o}{!} \PYG{o}{*} \PYG{n}{z} \PYG{p}{)} \PYG{k}{return} \PYG{n}{x} \PYG{p}{;} \PYG{p}{\PYGZcb{}} \PYG{k}{return} \PYG{l+m+mi}{0} \PYG{p}{;} \PYG{p}{\PYGZcb{}} \PYG{n}{main} \PYG{p}{(} \PYG{p}{)} \PYG{p}{\PYGZob{}} \PYG{n}{m} \PYG{p}{[} \PYG{l+m+mi}{11} \PYG{o}{*} \PYG{l+m+mi}{999} \PYG{p}{]} \PYG{o}{=} \PYG{l+s}{\PYGZdq{}E\PYGZdq{}} \PYG{p}{;} \PYG{k}{while} \PYG{p}{(} \PYG{n}{puts} \PYG{p}{(} \PYG{l+s}{\PYGZdq{}Ok\PYGZdq{}} \PYG{p}{)} \PYG{p}{,} \PYG{n}{gets} \PYG{p}{(} \PYG{n}{B} \PYG{p}{)}
\PYG{p}{)} \PYG{k}{switch} \PYG{p}{(} \PYG{o}{*} \PYG{n}{B} \PYG{p}{)} \PYG{p}{\PYGZob{}} \PYG{p}{;} \PYG{k}{break} \PYG{p}{;} \PYG{k}{case} \PYG{l+s+sc}{\PYGZsq{}R\PYGZsq{}} \PYG{o}{:} \PYG{n}{C} \PYG{o}{=} \PYG{n}{E} \PYG{p}{;} \PYG{n}{l} \PYG{o}{=} \PYG{l+m+mi}{1} \PYG{p}{;} \PYG{k}{for} \PYG{p}{(} \PYG{n}{i} \PYG{o}{=} \PYG{l+m+mi}{0} \PYG{p}{;} \PYG{n}{i} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{999} \PYG{p}{;} \PYG{n}{P} \PYG{p}{[} \PYG{n}{i} \PYG{o}{++} \PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{0} \PYG{p}{)} \PYG{p}{;} \PYG{k}{while} \PYG{p}{(} \PYG{n}{l} \PYG{p}{)} \PYG{p}{\PYGZob{}} \PYG{k}{while} \PYG{p}{(} \PYG{o}{!} \PYG{p}{(} \PYG{n}{s} \PYG{o}{=} \PYG{n}{m} \PYG{p}{[} \PYG{n}{l} \PYG{p}{]} \PYG{p}{)} \PYG{p}{)} \PYG{n}{l} \PYG{o}{++} \PYG{p}{;} \PYG{k}{if}
\PYG{p}{(} \PYG{o}{!} \PYG{n}{Q} \PYG{p}{(} \PYG{n}{s} \PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}\PYGZdq{}}\PYG{l+s}{\PYGZdq{}} \PYG{p}{)} \PYG{p}{)} \PYG{p}{\PYGZob{}} \PYG{k}{while} \PYG{p}{(} \PYG{n}{p} \PYG{o}{=} \PYG{n}{Q} \PYG{p}{(} \PYG{n}{s} \PYG{p}{,} \PYG{l+s}{\PYGZdq{}\PYGZlt{}\PYGZgt{}\PYGZdq{}} \PYG{p}{)} \PYG{p}{)} \PYG{o}{*} \PYG{n}{p} \PYG{o}{++} \PYG{o}{=} \PYG{l+s+sc}{\PYGZsq{}\PYGZsh{}\PYGZsq{}} \PYG{p}{,} \PYG{o}{*} \PYG{n}{p} \PYG{o}{=} \PYG{l+s+sc}{\PYGZsq{} \PYGZsq{}} \PYG{p}{;} \PYG{k}{while} \PYG{p}{(} \PYG{n}{p} \PYG{o}{=} \PYG{n}{Q} \PYG{p}{(} \PYG{n}{s} \PYG{p}{,} \PYG{l+s}{\PYGZdq{}\PYGZlt{}=\PYGZdq{}} \PYG{p}{)} \PYG{p}{)} \PYG{o}{*} \PYG{n}{p} \PYG{o}{++} \PYG{o}{=} \PYG{l+s+sc}{\PYGZsq{}\PYGZdl{}\PYGZsq{}} \PYG{p}{,} \PYG{o}{*} \PYG{n}{p} \PYG{o}{=} \PYG{l+s+sc}{\PYGZsq{} \PYGZsq{}} \PYG{p}{;} \PYG{k}{while} \PYG{p}{(} \PYG{n}{p} \PYG{o}{=} \PYG{n}{Q} \PYG{p}{(} \PYG{n}{s} \PYG{p}{,} \PYG{l+s}{\PYGZdq{}\PYGZgt{}=\PYGZdq{}} \PYG{p}{)} \PYG{p}{)} \PYG{o}{*} \PYG{n}{p} \PYG{o}{++} \PYG{o}{=} \PYG{l+s+sc}{\PYGZsq{}!\PYGZsq{}} \PYG{p}{,} \PYG{o}{*} \PYG{n}{p} \PYG{o}{=} \PYG{l+s+sc}{\PYGZsq{} \PYGZsq{}} \PYG{p}{;} \PYG{p}{\PYGZcb{}} \PYG{n}{d} \PYG{o}{=} \PYG{n}{B} \PYG{p}{;} \PYG{k}{while} \PYG{p}{(} \PYG{o}{*} \PYG{n}{F} \PYG{o}{=} \PYG{o}{*} \PYG{n}{s} \PYG{p}{)} \PYG{p}{\PYGZob{}} \PYG{o}{*} \PYG{n}{s} \PYG{o}{==} \PYG{l+s+sc}{\PYGZsq{}\PYGZdq{}\PYGZsq{}} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{n}{j}
\PYG{o}{++} \PYG{p}{;} \PYG{k}{if} \PYG{p}{(} \PYG{n}{j} \PYG{o}{\PYGZam{}} \PYG{l+m+mi}{1} \PYG{o}{||} \PYG{o}{!} \PYG{n}{Q} \PYG{p}{(} \PYG{l+s}{\PYGZdq{} }\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s}{\PYGZdq{}} \PYG{p}{,} \PYG{n}{F} \PYG{p}{)} \PYG{p}{)} \PYG{o}{*} \PYG{n}{d} \PYG{o}{++} \PYG{o}{=} \PYG{o}{*} \PYG{n}{s} \PYG{p}{;} \PYG{n}{s} \PYG{o}{++} \PYG{p}{;} \PYG{p}{\PYGZcb{}} \PYG{o}{*} \PYG{n}{d} \PYG{o}{\PYGZhy{}\PYGZhy{}} \PYG{o}{=} \PYG{n}{j} \PYG{o}{=} \PYG{l+m+mi}{0} \PYG{p}{;} \PYG{k}{if} \PYG{p}{(} \PYG{n}{B} \PYG{p}{[} \PYG{l+m+mi}{1} \PYG{p}{]} \PYG{o}{!=} \PYG{l+s+sc}{\PYGZsq{}=\PYGZsq{}} \PYG{p}{)} \PYG{k}{switch} \PYG{p}{(} \PYG{o}{*} \PYG{n}{B} \PYG{p}{)} \PYG{p}{\PYGZob{}} \PYG{p}{;} \PYG{k}{break} \PYG{p}{;} \PYG{k}{case} \PYG{l+s+sc}{\PYGZsq{}E\PYGZsq{}} \PYG{o}{:} \PYG{n}{l} \PYG{o}{=} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1}
\PYG{p}{;} \PYG{k}{break} \PYG{p}{;} \PYG{k}{case} \PYG{l+s+sc}{\PYGZsq{}R\PYGZsq{}} \PYG{o}{:} \PYG{n}{B} \PYG{p}{[} \PYG{l+m+mi}{2} \PYG{p}{]} \PYG{o}{!=} \PYG{l+s+sc}{\PYGZsq{}M\PYGZsq{}} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{p}{(} \PYG{n}{l} \PYG{o}{=} \PYG{o}{*} \PYG{o}{\PYGZhy{}\PYGZhy{}} \PYG{n}{C} \PYG{p}{)} \PYG{p}{;} \PYG{k}{break} \PYG{p}{;} \PYG{k}{case} \PYG{l+s+sc}{\PYGZsq{}I\PYGZsq{}} \PYG{o}{:} \PYG{n}{B} \PYG{p}{[} \PYG{l+m+mi}{1} \PYG{p}{]} \PYG{o}{==} \PYG{l+s+sc}{\PYGZsq{}N\PYGZsq{}} \PYG{o}{?} \PYG{n}{gets} \PYG{p}{(} \PYG{n}{p} \PYG{o}{=} \PYG{n}{B} \PYG{p}{)} \PYG{p}{,} \PYG{n}{P} \PYG{p}{[} \PYG{o}{*} \PYG{n}{d} \PYG{p}{]} \PYG{o}{=} \PYG{n}{S} \PYG{p}{(} \PYG{p}{)} \PYG{o}{:} \PYG{p}{(} \PYG{o}{*} \PYG{p}{(} \PYG{n}{q} \PYG{o}{=} \PYG{n}{Q} \PYG{p}{(} \PYG{n}{B} \PYG{p}{,} \PYG{l+s}{\PYGZdq{}TH\PYGZdq{}} \PYG{p}{)} \PYG{p}{)} \PYG{o}{=} \PYG{l+m+mi}{0} \PYG{p}{,} \PYG{n}{p}
\PYG{o}{=} \PYG{n}{B} \PYG{o}{+} \PYG{l+m+mi}{2} \PYG{p}{,} \PYG{n}{S} \PYG{p}{(} \PYG{p}{)} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{p}{(} \PYG{n}{p} \PYG{o}{=} \PYG{n}{q} \PYG{o}{+} \PYG{l+m+mi}{4} \PYG{p}{,} \PYG{n}{l} \PYG{o}{=} \PYG{n}{S} \PYG{p}{(} \PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1} \PYG{p}{)} \PYG{p}{)} \PYG{p}{;} \PYG{k}{break} \PYG{p}{;} \PYG{k}{case} \PYG{l+s+sc}{\PYGZsq{}P\PYGZsq{}} \PYG{o}{:} \PYG{n}{B} \PYG{p}{[} \PYG{l+m+mi}{5} \PYG{p}{]} \PYG{o}{==} \PYG{l+s+sc}{\PYGZsq{}\PYGZdq{}\PYGZsq{}} \PYG{o}{?} \PYG{o}{*} \PYG{n}{d} \PYG{o}{=} \PYG{l+m+mi}{0} \PYG{p}{,} \PYG{n}{puts} \PYG{p}{(} \PYG{n}{B} \PYG{o}{+} \PYG{l+m+mi}{6} \PYG{p}{)} \PYG{o}{:} \PYG{p}{(} \PYG{n}{p} \PYG{o}{=} \PYG{n}{B} \PYG{o}{+} \PYG{l+m+mi}{5} \PYG{p}{,} \PYG{n}{printf} \PYG{p}{(} \PYG{l+s}{\PYGZdq{}\PYGZpc{}d}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{\PYGZdq{}} \PYG{p}{,} \PYG{n}{S}
\PYG{p}{(} \PYG{p}{)} \PYG{p}{)} \PYG{p}{)} \PYG{p}{;} \PYG{k}{break} \PYG{p}{;} \PYG{k}{case} \PYG{l+s+sc}{\PYGZsq{}G\PYGZsq{}} \PYG{o}{:} \PYG{n}{p} \PYG{o}{=} \PYG{n}{B} \PYG{o}{+} \PYG{l+m+mi}{4} \PYG{p}{,} \PYG{n}{B} \PYG{p}{[} \PYG{l+m+mi}{2} \PYG{p}{]} \PYG{o}{==} \PYG{l+s+sc}{\PYGZsq{}S\PYGZsq{}} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{p}{(} \PYG{o}{*} \PYG{n}{C} \PYG{o}{++} \PYG{o}{=} \PYG{n}{l} \PYG{p}{,} \PYG{n}{p} \PYG{o}{++} \PYG{p}{)} \PYG{p}{,} \PYG{n}{l} \PYG{o}{=} \PYG{n}{S} \PYG{p}{(} \PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1} \PYG{p}{;} \PYG{k}{break} \PYG{p}{;} \PYG{k}{case} \PYG{l+s+sc}{\PYGZsq{}F\PYGZsq{}} \PYG{o}{:} \PYG{o}{*} \PYG{p}{(} \PYG{n}{q} \PYG{o}{=} \PYG{n}{Q} \PYG{p}{(} \PYG{n}{B} \PYG{p}{,} \PYG{l+s}{\PYGZdq{}TO\PYGZdq{}} \PYG{p}{)} \PYG{p}{)} \PYG{o}{=} \PYG{l+m+mi}{0} \PYG{p}{;} \PYG{n}{p} \PYG{o}{=} \PYG{n}{B} \PYG{o}{+} \PYG{l+m+mi}{5} \PYG{p}{;} \PYG{n}{P} \PYG{p}{[} \PYG{n}{i}
\PYG{o}{=} \PYG{n}{B} \PYG{p}{[} \PYG{l+m+mi}{3} \PYG{p}{]} \PYG{p}{]} \PYG{o}{=} \PYG{n}{S} \PYG{p}{(} \PYG{p}{)} \PYG{p}{;} \PYG{n}{p} \PYG{o}{=} \PYG{n}{q} \PYG{o}{+} \PYG{l+m+mi}{2} \PYG{p}{;} \PYG{n}{M} \PYG{p}{[} \PYG{n}{i} \PYG{p}{]} \PYG{o}{=} \PYG{n}{S} \PYG{p}{(} \PYG{p}{)} \PYG{p}{;} \PYG{n}{L} \PYG{p}{[} \PYG{n}{i} \PYG{p}{]} \PYG{o}{=} \PYG{n}{l} \PYG{p}{;} \PYG{k}{break} \PYG{p}{;} \PYG{k}{case} \PYG{l+s+sc}{\PYGZsq{}N\PYGZsq{}} \PYG{o}{:} \PYG{o}{++} \PYG{n}{P} \PYG{p}{[} \PYG{o}{*} \PYG{n}{d} \PYG{p}{]} \PYG{o}{\PYGZlt{}=} \PYG{n}{M} \PYG{p}{[} \PYG{o}{*} \PYG{n}{d} \PYG{p}{]} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{p}{(} \PYG{n}{l} \PYG{o}{=} \PYG{n}{L} \PYG{p}{[} \PYG{o}{*} \PYG{n}{d} \PYG{p}{]} \PYG{p}{)} \PYG{p}{;} \PYG{p}{\PYGZcb{}} \PYG{k}{else} \PYG{n}{p} \PYG{o}{=} \PYG{n}{B} \PYG{o}{+} \PYG{l+m+mi}{2} \PYG{p}{,} \PYG{n}{P} \PYG{p}{[}
\PYG{o}{*} \PYG{n}{B} \PYG{p}{]} \PYG{o}{=} \PYG{n}{S} \PYG{p}{(} \PYG{p}{)} \PYG{p}{;} \PYG{n}{l} \PYG{o}{++} \PYG{p}{;} \PYG{p}{\PYGZcb{}} \PYG{p}{;} \PYG{k}{break} \PYG{p}{;} \PYG{k}{case} \PYG{l+s+sc}{\PYGZsq{}L\PYGZsq{}} \PYG{o}{:} \PYG{k}{for} \PYG{p}{(} \PYG{n}{i} \PYG{o}{=} \PYG{l+m+mi}{0} \PYG{p}{;} \PYG{n}{i} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{11} \PYG{o}{*} \PYG{n}{R} \PYG{p}{;} \PYG{n}{i} \PYG{o}{++} \PYG{p}{)} \PYG{n}{m} \PYG{p}{[} \PYG{n}{i} \PYG{p}{]} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{n}{printf} \PYG{p}{(} \PYG{l+s}{\PYGZdq{}\PYGZpc{}d \PYGZpc{}s}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{\PYGZdq{}} \PYG{p}{,} \PYG{n}{i} \PYG{p}{,} \PYG{n}{m} \PYG{p}{[} \PYG{n}{i} \PYG{p}{]} \PYG{o}{!} \PYG{p}{)} \PYG{p}{;} \PYG{k}{break} \PYG{p}{;} \PYG{k}{case} \PYG{l+s+sc}{\PYGZsq{}N\PYGZsq{}} \PYG{o}{:} \PYG{k}{for} \PYG{p}{(} \PYG{n}{i} \PYG{o}{=} \PYG{l+m+mi}{0} \PYG{p}{;} \PYG{n}{i} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{11} \PYG{o}{*} \PYG{n}{R} \PYG{p}{;} \PYG{n}{i} \PYG{o}{++} \PYG{p}{)} \PYG{n}{m} \PYG{p}{[} \PYG{n}{i} \PYG{p}{]} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{n}{free} \PYG{p}{(} \PYG{n}{m} \PYG{p}{[} \PYG{n}{i} \PYG{p}{]} \PYG{p}{)} \PYG{p}{,} \PYG{n}{m} \PYG{p}{[} \PYG{n}{i} \PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{0} \PYG{p}{;} \PYG{k}{break} \PYG{p}{;} \PYG{k}{case} \PYG{l+s+sc}{\PYGZsq{}B\PYGZsq{}} \PYG{o}{:} \PYG{k}{return} \PYG{l+m+mi}{0} \PYG{n}{X} \PYG{l+s+sc}{\PYGZsq{}S\PYGZsq{}} \PYG{o}{:} \PYG{n}{f} \PYG{o}{=} \PYG{n}{fopen} \PYG{p}{(} \PYG{n}{B} \PYG{o}{+} \PYG{l+m+mi}{5} \PYG{p}{,} \PYG{l+s}{\PYGZdq{}w\PYGZdq{}} \PYG{p}{)} \PYG{p}{;} \PYG{n}{N} \PYG{n}{fprintf} \PYG{n}{f} \PYG{p}{;} \PYG{n}{fclos} \PYG{l+s+sc}{\PYGZsq{}S\PYGZsq{}} \PYG{p}{(} \PYG{n}{f} \PYG{p}{)}
\PYG{p}{)} \PYG{n}{X} \PYG{l+s+sc}{\PYGZsq{}O\PYGZsq{}} \PYG{o}{:} \PYG{n}{f} \PYG{o}{=} \PYG{n}{fopen} \PYG{p}{(} \PYG{n}{B} \PYG{o}{+} \PYG{l+m+mi}{4} \PYG{p}{,} \PYG{l+s}{\PYGZdq{}r\PYGZdq{}} \PYG{p}{)} \PYG{p}{;} \PYG{k}{while} \PYG{n}{fgets} \PYG{n}{B} \PYG{p}{;} \PYG{n}{fclos} \PYG{l+s+sc}{\PYGZsq{}O\PYGZsq{}} \PYG{p}{(} \PYG{n}{f} \PYG{p}{)} \PYG{p}{)} \PYG{p}{(} \PYG{o}{*} \PYG{n}{Q} \PYG{p}{(} \PYG{n}{B} \PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{\PYGZdq{}} \PYG{p}{)} \PYG{o}{=} \PYG{l+m+mi}{0} \PYG{p}{,} \PYG{n}{G} \PYG{p}{(} \PYG{p}{)} \PYG{p}{)} \PYG{p}{)} \PYG{p}{;} \PYG{k}{break} \PYG{p}{;} \PYG{k}{case} \PYG{l+m+mi}{0} \PYG{o}{:} \PYG{k}{default} \PYG{o}{:} \PYG{n}{G} \PYG{p}{(} \PYG{p}{)}
\end{Verbatim}
